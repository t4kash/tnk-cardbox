!function(){var a="4ofkpZSUMjDDFQowUnV7rrdTPb01XXhuKncyQt5b",b="BSr5oeZvUrD3ZZZly8W170VQ81A9Q0stDU0f61iL",c="http://t4kash.github.io/tnk-cardbox/",d=function(){var d=function(a,b){f();var d="#TNK_CARD_FRAME {  position: fixed;  top: 0px; left: 0px;  width: 100%;  height: 90px;  padding-top: 20px;  background: #ffffff;  z-index: 2147483647;  border-bottom: solid 2px black;  text-align: center;} #TNK_CARD_FRAME .btn {  border: 1px solid;  border-radius: 4px;  margin: 5px;  padding: 4px 8px;  background-color: #fff;  border-color: #ccc;} #TNK_CARD_FRAME .btn-warning {  color: #fff;  background-color: #f0ad4e;  border-color: #eea236;}",e='<div id="TNK_CARD_FRAME">';b&&(e=e+'  <img src="'+c+'images/loading.gif">'),e=e+" "+a+"<br>",b||(e+=' <input type="button" id="TNK_CARD_FORM_LOGOUT_BTN" class="btn btn-warning" value="ログアウト">'),e+="</div>";var g=document.createElement("div");g.innerHTML='<style id="TNK_CARD_STYLE">'+d+"</style>"+e,document.body.appendChild(g),setTimeout(function(){window.scrollTo(0,window.pageYOffset+1)},100),b||(m("#TNK_CARD_FORM_LOGOUT_BTN").click(function(){Parse.User.logOut(),f()}),setTimeout(function(){f()},5e3))},e=function(){f();var a="#TNK_CARD_FRAME {  position: fixed;  top: 0px; left: 0px;  width: 100%;  height: 130px;  padding-top: 10px;  background: #f0f0f0;  z-index: 2147483647;  border-bottom: solid 2px black;  text-align: center;} #TNK_CARD_FRAME .txt {  border: 2px inset;  margin: 2px;  padding: 4px;  background: white;} #TNK_CARD_FRAME .btn {  border: 1px solid;  border-radius: 4px;  margin: 5px;  padding: 4px 8px;  color: #333;  background-color: #fff;  border-color: #ccc;} #TNK_CARD_FRAME .btn-primary {  color: #fff;  background-color: #428bca;  border-color: #357ebd;} #TNK_CARD_FRAME .btn-warning {  color: #fff;  background-color: #f0ad4e;  border-color: #eea236;}",b='<div id="TNK_CARD_FRAME">  <form id="TNK_CARD_FORM">    <input type="text" id="TNK_CARD_FORM_ID" class="txt" placeholder="Login ID"><br>    <input type="password" id="TNK_CARD_FORM_PASSWORD" class="txt" placeholder="Password"><br>    <input type="submit" id="TNK_CARD_FORM_LOGIN_BTN" class="btn btn-primary" value="ログイン">    <input type="button" id="TNK_CARD_FORM_CLOSE_BTN" class="btn btn-warning" value="閉じる">  </form></div>',c=document.createElement("div");c.innerHTML='<style id="TNK_CARD_STYLE">'+a+"</style>"+b,document.body.appendChild(c),setTimeout(function(){window.scrollTo(0,window.pageYOffset+1)},100),m("#TNK_CARD_FORM").submit(function(a){a.preventDefault(),m("#TNK_CARD_FORM_LOGIN_BTN").attr("disabled",!0);var b=m("#TNK_CARD_FORM_ID").val(),c=m("#TNK_CARD_FORM_PASSWORD").val();Parse.User.logIn(b,c,{success:function(){f(),l()},error:function(a,b){m("#TNK_CARD_FORM_LOGIN_BTN").attr("disabled",!1),b.code==Parse.Error.OBJECT_NOT_FOUND?alert("IDもしくはパスワードのエラー"):(alert("ログインできません:"+b.code),console.log(b))}})}),m("#TNK_CARD_FORM_CLOSE_BTN").click(function(){f()})},f=function(){var a=document.getElementById("TNK_CARD_FRAME");a&&a.parentNode.removeChild(a),a=document.getElementById("TNK_CARD_STYLE"),a&&a.parentNode.removeChild(a)},g=function(){var a="",b=m("#cardDetailDialog");return 0!=b.size()&&"block"==b.css("display")&&(a=b.find("#cardActionList").attr("data-user-card-id"),"undefined"==typeof a&&(a="")),a},h=function(a){var b=a.match(/^([0-9]+)\/([0-9]+)(★*)$/);return{level:parseInt(b[1]),maxLevel:parseInt(b[2]),extendLevel:b[3].length}},i=function(a,b){var c=b.find(".cardName"),d=b.find(".cardSkill"),e=h(b.find(".cardLevelValue").text());return{cardId:a,name:c.attr("data-card-name"),nameKana:c.attr("data-kana-name"),rarity:c.attr("data-rarity"),region:b.find(".regionBackgroundColor").text(),level:e.level,maxLevel:e.maxLevel,extendLevel:e.extendLevel,cost:parseInt(b.find(".cardCost").text()),attack:parseInt(b.find(".cardAttackPt").text()),defence:parseInt(b.find(".cardDefencePt").text()),type:b.find(".cardType").text(),skill:d.attr("data-skill-description"),skillLevel:parseInt(d.attr("data-skill-level")),skillName:d.attr("data-skill-name"),skillTarget:d.attr("data-skill-target")}},j=function(a,b){var c=Parse.Object.extend("Card"),e=Parse.User.current(),f=[];a.forEach(function(a){for(var d=null,g=0;g<b.length;g++)if(b[g].get("cardId")==a.cardId){d=b[g];break}d||(d=new c),a.userName=e.get("userName"),d.set(a),d.set("user",e);var h=new Parse.ACL(e);d.setACL(h),f.push(d)}),Parse.Object.saveAll(f,{success:function(){console.log("success"),d("送信完了!!!",!1)},error:function(a){console.log("error:"+a.code+" "+a.message),d("エラーが発生しました:"+a.code)}})},k=function(a){d("カード情報を送信しています",!0);var b=Parse.Object.extend("Card"),c=Parse.User.current(),f=new Parse.Query(b);f.equalTo("user",c);var g=[];a.forEach(function(a){g.push(a.cardId)}),f.containedIn("cardId",g),f.find({success:function(b){console.log("Successfully retrieved "+b.length+" scores."),j(a,b)},error:function(a){console.log("error:"+a.code+" "+a.message),alert("エラーが発生しました:"+a.code),e()}})},l=function(){for(var a=g(),b=[],c=m(".resultCardList").children(),d=0;d<c.length;d++){var e=c.eq(d);if(-1==e.attr("class").indexOf("hidden")){var f=e.attr("data-user-card-id");if((""==a||f==a)&&(b.push(i(f,e)),f==a))break}}return console.log("read num:"+b.length),0==b.length?void alert("カード情報が見つかりません"):void k(b)},m=jQuery.noConflict(!0);Parse.initialize(a,b),Parse.User.current()?(console.log("login!"),l()):(console.log("not login!"),e())},e=function(a,b){var c=document.createElement("script");c.type="text/javascript",c.src=a,c.onload=b;var d=document.getElementsByTagName("head")[0]||document.documentElement;d.appendChild(c)};e(c+"js/parse-1.2.16.js",function(){e("//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js",d)})}();